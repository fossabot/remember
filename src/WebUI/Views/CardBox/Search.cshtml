@using WebUI.Models.CardBoxVM
@model SearchResultViewModel
@{
	Layout = null;
}


<!DOCTYPE html>

<html>
<head>
	<meta name="viewport" content="width=device-width" />
	<title>Test</title>
	<link href="/assets/libs/mdui/dist/css/mdui.min.css" rel="stylesheet" />
	<link href="/assets/css/app.css" rel="stylesheet" />
	<style>
		.dialog-content {
			padding: 30px;
		}

		#content-main {
			/*padding: 20px;*/
			width: 100%;
			/*height: 700px;*/
			font-size: 50px;
		}
	</style>
</head>
<body class="mdui-appbar-with-toolbar mdui-theme-primary-teal mdui-bottom-nav-fixed">
	<!-- 头部 -->
	<header class="mdui-appbar mdui-appbar-fixed" id="content-header">
		<div class="mdui-toolbar mdui-color-white mdui-text-color-theme">
			<a href="javascript:;" class="mdui-btn mdui-btn-icon"><i class="mdui-icon material-icons">navigate_before</i></a>
			<a id="js-refresh" href="javascript:;" class="mdui-btn mdui-btn-icon"><i class="mdui-icon material-icons">refresh</i></a>
			<div class="mdui-toolbar-spacer"></div>
			<div class="mdui-textfield mdui-textfield-expandable mdui-textfield-expanded">
				<button id="js-btn-search" class="mdui-textfield-icon mdui-btn mdui-btn-icon"><i class="mdui-icon material-icons">search</i></button>
				<input id="js-input-keyword" class="mdui-textfield-input" type="text" placeholder="搜索卡片" value="@ViewBag.Q" />
				<button id="js-btn-close" class="mdui-textfield-close mdui-btn mdui-btn-icon mdui-hidden"><i class="mdui-icon material-icons">close</i></button>
			</div>
		</div>
	</header>
	<!-- 内容 -->
	<div class="mdui-container" id="content-main">
		<div class="mdui-row">
			<div class="mdui-col-xs-12">
				<ul id="js-result-list" class="mdui-list">
					@foreach (var item in Model.List)
					{
						<li class="mdui-list-item mdui-ripple">
							<a class="mdui-list-item-content" href="@item.Url">
								<div class="mdui-list-item-title mdui-list-item-one-line">@item.Title</div>
								<div class="mdui-list-item-text mdui-list-item-two-line">@(item.Description)...</div>
							</a>
						</li>
					}
				</ul>
			</div>
		</div>
	</div>
	<script src="/assets/libs/mdui/dist/js/mdui.min.js"></script>
	<script src="/assets/libs/jquery/dist/jquery.min.js"></script>
	<script>
		var $$ = mdui.JQ;

		$(function () {

			$("#js-refresh").on("click", function () {
				window.location.href = window.location.href;
			});

			$("#js-input-keyword").on("input propertychange", function () {
				var keyword = $(this).val().trim();
				if (keyword != "" && keyword.length > 0) {
					$("#js-btn-close").removeClass("mdui-hidden");
				} else {
					$("#js-btn-close").addClass("mdui-hidden");
				}
				$.ajax({
					url: '/CardBox/Search',
					type:'POST',
					data: { q: keyword },
					success: function(data) {
						loadResultList(data);
					}
				});
			});

			$("#js-btn-close").on("click", function () {
				$("#js-input-keyword").val("");
				$("#js-btn-close").addClass("mdui-hidden");

				return false;
			});

		});

		function loadResultList(data) {
			var listHtml = '';
			var list = data.List;
			var item = null;
			for (var i = 0; i < list.length; i++) {
				item = list[i];
				listHtml += '<li class="mdui-list-item mdui-ripple">\
								<a class="mdui-list-item-content" href="'+ item.Url +'">\
									<div class="mdui-list-item-title mdui-list-item-one-line">' + item.Title + '</div>\
									<div class="mdui-list-item-text mdui-list-item-two-line">' + item.Description + '...</div>\
								</a>\
							 </li>';
			}
			$("#js-result-list").html(listHtml);
		}

	</script>
</body>
</html>
